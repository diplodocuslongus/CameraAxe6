<script>
    var request;
    window.onload = updateState;

    function updateState() {
        setTimeout(updateState, 1000);
        document.getElementById("id1000").innerHTML = "Done";
        server = "updateAll";
        request = new XMLHttpRequest();
        request.onreadystatechange = updateStatus;
        request.open("GET", server, true);
        request.send();
    }

    function updateStatus() {
        if ((request.readyState == 4) && (request.status == 200))
        {
            result = request.responseText;
            document.getElementById("id0").innerHTML = result;
        }
    }

    function sendButton(id){
        document.getElementById("id1000").innerHTML = "ButtonClick";
        server = "button" + id;
        request = new XMLHttpRequest();
        request.open("GET", server, true);
        request.send();
    }

    function sendInt(id, value){
        valNum = "valueInt" + id;
        document.getElementById(valNum).innerHTML=value;
        document.getElementById("id1000").innerHTML = "Processing Int";
        server = "int/" + id + "/" + value;
        request = new XMLHttpRequest();
        request.onreadystatechange = updateAsyncInt;
        request.open("GET", server, true);
        request.send();
    }
    function updateAsyncInt(){
        if ((request.readyState == 4) && (request.status == 200))
        {
            result = request.responseText;
            singleset = result.split(",");
            pinType = singleset[0];
            pinNum = singleset[1];
            pinVal = parseInt(singleset[2]);
            intNum = "int" + PinNum;
            valNum = "valueInt" + PinNum;
            document.getElementById(intNum).value = pinVal;
            document.getElementById(valNum).innerHTML = pinVal;
            document.getElementById("id1000").innerHTML = result;
        }
    }
    
    var gTable;
    
    function caStartMenu(majorVersion, minorVersion, menuString) {
        document.getElementById("title").innerHTML = menuString;
        
        gTable = document.createElement('table');
    }

    function caTextStatic(text0) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.colSpan = "2";
        cell0.innerHTML = text0;
    }
    
    function caTextDynamic(id, modAttribute, text0, text1) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        cell1.id = id;
        cell1.innerHTML = text1;
    }
    
    function caButton(id, modAttribute, text0, text1) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        var b = document.createElement('button');
        b.innerHTML = text1;
        b.onclick = function(){sendButton(0);}
        cell1.appendChild(b);
    }

    function caCheckBox(id, modAttribute, value, text0) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        var x = document.createElement('input');
        x.type = "checkbox";
        x.id = id;
        cell1.appendChild(x);
    }

    function caDropSelect(id, modAttribute, value, text0, text1) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        var x = document.createElement('select');
        
        var a = text1.split("|");
        var i;
        
        for(i=0; i<a.length; i++) {
            var option = document.createElement('option');
            option.value = a[i];
            option.textContent = a[i];
            x.appendChild(option);
        }
        cell1.appendChild(x);
    }

    function caEditNumber(id, modAttribute, digitsBeforeDecimal, digitsAfterDecimal, minValue, maxValue, value, text0) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        var x = document.createElement('input');
        x.type = "number"
        //x.size = 2;
        x.value = value;
        cell1.appendChild(x);
    }

    function caTimeBox(id, modAttribute, hours, minutes, seconds, milliseconds, microseconds, nanoseconds, text0) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        var x = document.createElement('input');
        x.type = "text"
        //x.size = 2;
        x.value = hours+":"+minutes+":"+seconds+"."+milliseconds+"."+microseconds+"."+nanoseconds;
        cell1.appendChild(x);
    }

    function caSlider(id, modAttribute, minValue, maxValue, value, text0) {
        var row = gTable.insertRow();
        var cell0 = row.insertCell();
        cell0.innerHTML = text0;
        var cell1 = row.insertCell();
        var x = document.createElement('input');
        x.class = "slider";
        x.type = "range";
        x.id = id;
        x.min="0";
        x.max="255";
        x.value="10";
        x.step="1";
        x.onchange = function(){sendDac(document.getElementById('pin5').value, this.value);}
        //x.size = 2;
        cell1.appendChild(x);
        var x1 = document.createElement('span');
        x1.id = id+"b";
        x1.innerHTML = "abc";
        cell1.appendChild(x1);
    }

    function caEndMenu() {
        document.body.appendChild(gTable);        
    }
</script>
